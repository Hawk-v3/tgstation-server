<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>tgstation-server: src/Tgstation.Server.Host/Setup/SetupWizard.cs File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="tgs.ico"/></td>
  <td id="projectalign">
   <div id="projectname">tgstation-server<span id="projectnumber">&#160;5.14.0</span>
   </div>
   <div id="projectbrief">The /tg/station 13 server suite</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_34761767c1c3cd212f9d2f80ea0828a8.html">Tgstation.Server.Host</a></li><li class="navelem"><a class="el" href="dir_6d5d151b7baf54e07e6b0a3941fbad55.html">Setup</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#namespaces">Namespaces</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">SetupWizard.cs File Reference</div></div>
</div><!--header-->
<div class="contents">

<p><a href="_setup_wizard_8cs_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_setup_1_1_setup_wizard.html">Tgstation.Server.Host.Setup.SetupWizard</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="namespaces" name="namespaces"></a>
Namespaces</h2></td></tr>
<tr class="memitem:namespace_tgstation"><td class="memItemLeft" align="right" valign="top">namespace &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_tgstation.html">Tgstation</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:namespace_tgstation_1_1_server"><td class="memItemLeft" align="right" valign="top">namespace &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_tgstation_1_1_server.html">Tgstation.Server</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:namespace_tgstation_1_1_server_1_1_host"><td class="memItemLeft" align="right" valign="top">namespace &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_tgstation_1_1_server_1_1_host.html">Tgstation.Server.Host</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:namespace_tgstation_1_1_server_1_1_host_1_1_setup"><td class="memItemLeft" align="right" valign="top">namespace &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_tgstation_1_1_server_1_1_host_1_1_setup.html">Tgstation.Server.Host.Setup</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a4e1161b3a1401977cf30b588f69f4606"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_tgstation_1_1_server_1_1_host_1_1_setup.html#a4e1161b3a1401977cf30b588f69f4606">Tgstation.Server.Host.Setup.while</a> (true)</td></tr>
<tr class="separator:a4e1161b3a1401977cf30b588f69f4606"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c8f5f56a7438fe48011eb8d738abec8"><td class="memItemLeft" align="right" valign="top">async Task&lt; <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_general_configuration.html">GeneralConfiguration</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_setup_wizard_8cs.html#a8c8f5f56a7438fe48011eb8d738abec8">ConfigureGeneral</a> (CancellationToken cancellationToken)</td></tr>
<tr class="memdesc:a8c8f5f56a7438fe48011eb8d738abec8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prompts the user to create a GeneralConfiguration.   <a href="_setup_wizard_8cs.html#a8c8f5f56a7438fe48011eb8d738abec8">More...</a><br /></td></tr>
<tr class="separator:a8c8f5f56a7438fe48011eb8d738abec8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adbd38b2960ebef44f65c5b8e0af409b0"><td class="memItemLeft" align="right" valign="top">async Task&lt; <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_file_logging_configuration.html">FileLoggingConfiguration</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_setup_wizard_8cs.html#adbd38b2960ebef44f65c5b8e0af409b0">ConfigureLogging</a> (CancellationToken cancellationToken)</td></tr>
<tr class="memdesc:adbd38b2960ebef44f65c5b8e0af409b0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prompts the user to create a FileLoggingConfiguration.   <a href="_setup_wizard_8cs.html#adbd38b2960ebef44f65c5b8e0af409b0">More...</a><br /></td></tr>
<tr class="separator:adbd38b2960ebef44f65c5b8e0af409b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c25292615cd1ecad91305b36ea7068e"><td class="memItemLeft" align="right" valign="top">async Task&lt; <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_elasticsearch_configuration.html">ElasticsearchConfiguration</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_setup_wizard_8cs.html#a8c25292615cd1ecad91305b36ea7068e">ConfigureElasticsearch</a> (CancellationToken cancellationToken)</td></tr>
<tr class="memdesc:a8c25292615cd1ecad91305b36ea7068e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prompts the user to create a ElasticsearchConfiguration.   <a href="_setup_wizard_8cs.html#a8c25292615cd1ecad91305b36ea7068e">More...</a><br /></td></tr>
<tr class="separator:a8c25292615cd1ecad91305b36ea7068e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a46a4314202bbe55ae8724e7d27486163"><td class="memItemLeft" align="right" valign="top">async Task&lt; <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_control_panel_configuration.html">ControlPanelConfiguration</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_setup_wizard_8cs.html#a46a4314202bbe55ae8724e7d27486163">ConfigureControlPanel</a> (CancellationToken cancellationToken)</td></tr>
<tr class="memdesc:a46a4314202bbe55ae8724e7d27486163"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prompts the user to create a ControlPanelConfiguration.   <a href="_setup_wizard_8cs.html#a46a4314202bbe55ae8724e7d27486163">More...</a><br /></td></tr>
<tr class="separator:a46a4314202bbe55ae8724e7d27486163"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a159af60f0c66366ede5c65cb6e21e5ea"><td class="memItemLeft" align="right" valign="top">async Task&lt; <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_swarm_configuration.html">SwarmConfiguration</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_setup_wizard_8cs.html#a159af60f0c66366ede5c65cb6e21e5ea">ConfigureSwarm</a> (CancellationToken cancellationToken)</td></tr>
<tr class="memdesc:a159af60f0c66366ede5c65cb6e21e5ea"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prompts the user to create a SwarmConfiguration.   <a href="_setup_wizard_8cs.html#a159af60f0c66366ede5c65cb6e21e5ea">More...</a><br /></td></tr>
<tr class="separator:a159af60f0c66366ede5c65cb6e21e5ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb6b6fca0a8f1d72dd4e4f5cc84f76f1"><td class="memItemLeft" align="right" valign="top">async Task&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_setup_wizard_8cs.html#afb6b6fca0a8f1d72dd4e4f5cc84f76f1">SaveConfiguration</a> (string userConfigFileName, ushort? hostingPort, <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_database_configuration.html">DatabaseConfiguration</a> databaseConfiguration, <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_general_configuration.html">GeneralConfiguration</a> newGeneralConfiguration, <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_file_logging_configuration.html">FileLoggingConfiguration</a> fileLoggingConfiguration, <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_elasticsearch_configuration.html">ElasticsearchConfiguration</a> elasticsearchConfiguration, <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_control_panel_configuration.html">ControlPanelConfiguration</a> controlPanelConfiguration, <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_swarm_configuration.html">SwarmConfiguration</a> swarmConfiguration, CancellationToken cancellationToken)</td></tr>
<tr class="memdesc:afb6b6fca0a8f1d72dd4e4f5cc84f76f1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Saves a given Configuration set to <em>userConfigFileName</em> .   <a href="_setup_wizard_8cs.html#afb6b6fca0a8f1d72dd4e4f5cc84f76f1">More...</a><br /></td></tr>
<tr class="separator:afb6b6fca0a8f1d72dd4e4f5cc84f76f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a133aa9167bebce98243748fe735a4e32"><td class="memItemLeft" align="right" valign="top">async Task&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_setup_wizard_8cs.html#a133aa9167bebce98243748fe735a4e32">RunWizard</a> (string userConfigFileName, CancellationToken cancellationToken)</td></tr>
<tr class="memdesc:a133aa9167bebce98243748fe735a4e32"><td class="mdescLeft">&#160;</td><td class="mdescRight">Runs the SetupWizard.   <a href="_setup_wizard_8cs.html#a133aa9167bebce98243748fe735a4e32">More...</a><br /></td></tr>
<tr class="separator:a133aa9167bebce98243748fe735a4e32"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac16c05e965ab067e23152458aa6fe59"><td class="memItemLeft" align="right" valign="top">async Task&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_setup_wizard_8cs.html#aac16c05e965ab067e23152458aa6fe59">CheckRunWizard</a> (CancellationToken cancellationToken)</td></tr>
<tr class="memdesc:aac16c05e965ab067e23152458aa6fe59"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if it should and run the SetupWizard if necessary.   <a href="_setup_wizard_8cs.html#aac16c05e965ab067e23152458aa6fe59">More...</a><br /></td></tr>
<tr class="separator:aac16c05e965ab067e23152458aa6fe59"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="aac16c05e965ab067e23152458aa6fe59" name="aac16c05e965ab067e23152458aa6fe59"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aac16c05e965ab067e23152458aa6fe59">&#9670;&#160;</a></span>CheckRunWizard()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">async Task CheckRunWizard </td>
          <td>(</td>
          <td class="paramtype">CancellationToken&#160;</td>
          <td class="paramname"><em>cancellationToken</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check if it should and run the SetupWizard if necessary.  </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cancellationToken</td><td>The CancellationToken for the operation.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A Task representing the running operation.</dd></dl>

<p class="definition">Definition at line <a class="el" href="_setup_wizard_8cs_source.html#l01095">1095</a> of file <a class="el" href="_setup_wizard_8cs_source.html">SetupWizard.cs</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1096</span>        {</div>
<div class="line"><span class="lineno"> 1097</span>            var setupWizardMode = generalConfiguration.SetupWizardMode;</div>
<div class="line"><span class="lineno"> 1098</span>            <span class="keywordflow">if</span> (setupWizardMode == <a class="code hl_enumeration" href="namespace_tgstation_1_1_server_1_1_host_1_1_setup.html#ada83b66b0eb589bb855302d25c41e4de">SetupWizardMode</a>.Never)</div>
<div class="line"><span class="lineno"> 1099</span>                <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1100</span> </div>
<div class="line"><span class="lineno"> 1101</span>            var forceRun = setupWizardMode == SetupWizardMode.Force || setupWizardMode == <a class="code hl_enumeration" href="namespace_tgstation_1_1_server_1_1_host_1_1_setup.html#ada83b66b0eb589bb855302d25c41e4de">SetupWizardMode</a>.Only;</div>
<div class="line"><span class="lineno"> 1102</span>            <span class="keywordflow">if</span> (!console.Available)</div>
<div class="line"><span class="lineno"> 1103</span>            {</div>
<div class="line"><span class="lineno"> 1104</span>                <span class="keywordflow">if</span> (forceRun)</div>
<div class="line"><span class="lineno"> 1105</span>                    <span class="keywordflow">throw</span> <span class="keyword">new</span> InvalidOperationException(<span class="stringliteral">&quot;Asked to run setup wizard with no console avaliable!&quot;</span>);</div>
<div class="line"><span class="lineno"> 1106</span>                <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1107</span>            }</div>
<div class="line"><span class="lineno"> 1108</span> </div>
<div class="line"><span class="lineno"> 1109</span>            var userConfigFileName = ioManager.ConcatPath(</div>
<div class="line"><span class="lineno"> 1110</span>                internalConfiguration.AppSettingsBasePath,</div>
<div class="line"><span class="lineno"> 1111</span>                String.Format(CultureInfo.InvariantCulture, <span class="stringliteral">&quot;appsettings.{0}.yml&quot;</span>, hostingEnvironment.EnvironmentName));</div>
<div class="line"><span class="lineno"> 1112</span> </div>
<div class="line"><span class="lineno"> 1113</span>            async Task HandleSetupCancel()</div>
<div class="line"><span class="lineno"> 1114</span>            {</div>
<div class="line"><span class="lineno"> 1115</span>                <span class="comment">// DCTx2: Operation should always run</span></div>
<div class="line"><span class="lineno"> 1116</span>                await console.WriteAsync(String.Empty, <span class="keyword">true</span>, <span class="keywordflow">default</span>);</div>
<div class="line"><span class="lineno"> 1117</span>                await console.WriteAsync(<span class="stringliteral">&quot;Aborting setup!&quot;</span>, <span class="keyword">true</span>, <span class="keywordflow">default</span>);</div>
<div class="line"><span class="lineno"> 1118</span>            }</div>
<div class="line"><span class="lineno"> 1119</span> </div>
<div class="line"><span class="lineno"> 1120</span>            Task finalTask = Task.CompletedTask;</div>
<div class="line"><span class="lineno"> 1121</span>            <span class="keywordtype">string</span> originalConsoleTitle = <span class="keyword">null</span>;</div>
<div class="line"><span class="lineno"> 1122</span>            <span class="keywordtype">void</span> SetConsoleTitle()</div>
<div class="line"><span class="lineno"> 1123</span>            {</div>
<div class="line"><span class="lineno"> 1124</span>                <span class="keywordflow">if</span> (originalConsoleTitle != <span class="keyword">null</span>)</div>
<div class="line"><span class="lineno"> 1125</span>                    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1126</span> </div>
<div class="line"><span class="lineno"> 1127</span>                originalConsoleTitle = console.Title;</div>
<div class="line"><span class="lineno"> 1128</span>                console.Title = $<span class="stringliteral">&quot;{assemblyInformationProvider.VersionString} Setup Wizard&quot;</span>;</div>
<div class="line"><span class="lineno"> 1129</span>            }</div>
<div class="line"><span class="lineno"> 1130</span> </div>
<div class="line"><span class="lineno"> 1131</span>            <span class="comment">// Link passed cancellationToken with cancel key press</span></div>
<div class="line"><span class="lineno"> 1132</span>            <span class="keyword">using</span> (var cts = CancellationTokenSource.CreateLinkedTokenSource(cancellationToken, console.CancelKeyPress))</div>
<div class="line"><span class="lineno"> 1133</span>            <span class="keyword">using</span> ((cancellationToken = cts.Token).Register(() =&gt; finalTask = HandleSetupCancel()))</div>
<div class="line"><span class="lineno"> 1134</span>                <span class="keywordflow">try</span></div>
<div class="line"><span class="lineno"> 1135</span>                {</div>
<div class="line"><span class="lineno"> 1136</span>                    var exists = await ioManager.FileExists(userConfigFileName, cancellationToken);</div>
<div class="line"><span class="lineno"> 1137</span>                    <span class="keywordflow">if</span> (!exists)</div>
<div class="line"><span class="lineno"> 1138</span>                    {</div>
<div class="line"><span class="lineno"> 1139</span>                        var legacyJsonFileName = $<span class="stringliteral">&quot;appsettings.{hostingEnvironment.EnvironmentName}.json&quot;</span>;</div>
<div class="line"><span class="lineno"> 1140</span>                        exists = await ioManager.FileExists(legacyJsonFileName, cancellationToken);</div>
<div class="line"><span class="lineno"> 1141</span>                        <span class="keywordflow">if</span> (exists)</div>
<div class="line"><span class="lineno"> 1142</span>                            userConfigFileName = legacyJsonFileName;</div>
<div class="line"><span class="lineno"> 1143</span>                    }</div>
<div class="line"><span class="lineno"> 1144</span> </div>
<div class="line"><span class="lineno"> 1145</span>                    <span class="keywordtype">bool</span> shouldRunBasedOnAutodetect;</div>
<div class="line"><span class="lineno"> 1146</span>                    <span class="keywordflow">if</span> (exists)</div>
<div class="line"><span class="lineno"> 1147</span>                    {</div>
<div class="line"><span class="lineno"> 1148</span>                        var bytes = await ioManager.ReadAllBytes(userConfigFileName, cancellationToken);</div>
<div class="line"><span class="lineno"> 1149</span>                        var contents = Encoding.UTF8.GetString(bytes);</div>
<div class="line"><span class="lineno"> 1150</span>                        var lines = contents.Split(<span class="charliteral">&#39;\n&#39;</span>, StringSplitOptions.RemoveEmptyEntries);</div>
<div class="line"><span class="lineno"> 1151</span>                        var existingConfigIsEmpty = lines</div>
<div class="line"><span class="lineno"> 1152</span>                            .Select(line =&gt; line.Trim())</div>
<div class="line"><span class="lineno"> 1153</span>                            .All(line =&gt; line[0] == <span class="charliteral">&#39;#&#39;</span> || line == <span class="stringliteral">&quot;{}&quot;</span> || line.Length == 0);</div>
<div class="line"><span class="lineno"> 1154</span>                        shouldRunBasedOnAutodetect = existingConfigIsEmpty;</div>
<div class="line"><span class="lineno"> 1155</span>                    }</div>
<div class="line"><span class="lineno"> 1156</span>                    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1157</span>                        shouldRunBasedOnAutodetect = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1158</span> </div>
<div class="line"><span class="lineno"> 1159</span>                    <span class="keywordflow">if</span> (!shouldRunBasedOnAutodetect)</div>
<div class="line"><span class="lineno"> 1160</span>                    {</div>
<div class="line"><span class="lineno"> 1161</span>                        <span class="keywordflow">if</span> (forceRun)</div>
<div class="line"><span class="lineno"> 1162</span>                        {</div>
<div class="line"><span class="lineno"> 1163</span>                            SetConsoleTitle();</div>
<div class="line"><span class="lineno"> 1164</span>                            await console.WriteAsync(String.Format(CultureInfo.InvariantCulture, <span class="stringliteral">&quot;The configuration settings are requesting the setup wizard be run, but you already appear to have a configuration file ({0})!&quot;</span>, userConfigFileName), <span class="keyword">true</span>, cancellationToken);</div>
<div class="line"><span class="lineno"> 1165</span> </div>
<div class="line"><span class="lineno"> 1166</span>                            forceRun = await PromptYesNo(<span class="stringliteral">&quot;Continue running setup wizard?&quot;</span>, <span class="keyword">false</span>, cancellationToken);</div>
<div class="line"><span class="lineno"> 1167</span>                        }</div>
<div class="line"><span class="lineno"> 1168</span> </div>
<div class="line"><span class="lineno"> 1169</span>                        <span class="keywordflow">if</span> (!forceRun)</div>
<div class="line"><span class="lineno"> 1170</span>                            <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1171</span>                    }</div>
<div class="line"><span class="lineno"> 1172</span> </div>
<div class="line"><span class="lineno"> 1173</span>                    SetConsoleTitle();</div>
<div class="line"><span class="lineno"> 1174</span> </div>
<div class="line"><span class="lineno"> 1175</span>                    <span class="comment">// flush the logs to prevent console conflicts</span></div>
<div class="line"><span class="lineno"> 1176</span>                    await asyncDelayer.Delay(TimeSpan.FromSeconds(1), cancellationToken);</div>
<div class="line"><span class="lineno"> 1177</span> </div>
<div class="line"><span class="lineno"> 1178</span>                    await <a class="code hl_function" href="_setup_wizard_8cs.html#a133aa9167bebce98243748fe735a4e32">RunWizard</a>(userConfigFileName, cancellationToken);</div>
<div class="line"><span class="lineno"> 1179</span>                }</div>
<div class="line"><span class="lineno"> 1180</span>                <span class="keywordflow">finally</span></div>
<div class="line"><span class="lineno"> 1181</span>                {</div>
<div class="line"><span class="lineno"> 1182</span>                    await finalTask;</div>
<div class="line"><span class="lineno"> 1183</span>                    <span class="keywordflow">if</span> (originalConsoleTitle != <span class="keyword">null</span>)</div>
<div class="line"><span class="lineno"> 1184</span>                        console.Title = originalConsoleTitle;</div>
<div class="line"><span class="lineno"> 1185</span>                }</div>
<div class="line"><span class="lineno"> 1186</span>        }</div>
<div class="ttc" id="a_setup_wizard_8cs_html_a133aa9167bebce98243748fe735a4e32"><div class="ttname"><a href="_setup_wizard_8cs.html#a133aa9167bebce98243748fe735a4e32">RunWizard</a></div><div class="ttdeci">async Task RunWizard(string userConfigFileName, CancellationToken cancellationToken)</div><div class="ttdoc">Runs the SetupWizard.</div><div class="ttdef"><b>Definition:</b> <a href="_setup_wizard_8cs_source.html#l01056">SetupWizard.cs:1056</a></div></div>
<div class="ttc" id="anamespace_tgstation_1_1_server_1_1_host_1_1_setup_html_ada83b66b0eb589bb855302d25c41e4de"><div class="ttname"><a href="namespace_tgstation_1_1_server_1_1_host_1_1_setup.html#ada83b66b0eb589bb855302d25c41e4de">Tgstation.Server.Host.Setup.SetupWizardMode</a></div><div class="ttdeci">SetupWizardMode</div><div class="ttdoc">Determines if the SetupWizard will run.</div><div class="ttdef"><b>Definition:</b> <a href="_setup_wizard_mode_8cs_source.html#l00006">SetupWizardMode.cs:7</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="_setup_wizard_8cs_source.html#l01056">RunWizard()</a>.</p>

<p class="reference">Referenced by <a class="el" href="_setup_wizard_8cs_source.html#l00142">Tgstation.Server.Host.Setup.SetupWizard.ExecuteAsync()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="_setup_wizard_8cs_aac16c05e965ab067e23152458aa6fe59_cgraph.png" border="0" usemap="#a_setup_wizard_8cs_aac16c05e965ab067e23152458aa6fe59_cgraph" alt=""/></div>
<map name="a_setup_wizard_8cs_aac16c05e965ab067e23152458aa6fe59_cgraph" id="a_setup_wizard_8cs_aac16c05e965ab067e23152458aa6fe59_cgraph">
<area shape="rect" title="Check if it should and run the SetupWizard if necessary." alt="" coords="5,129,127,155"/>
<area shape="rect" href="_setup_wizard_8cs.html#a133aa9167bebce98243748fe735a4e32" title="Runs the SetupWizard." alt="" coords="175,129,259,155"/>
<area shape="rect" href="_setup_wizard_8cs.html#a46a4314202bbe55ae8724e7d27486163" title="Prompts the user to create a ControlPanelConfiguration." alt="" coords="309,5,459,31"/>
<area shape="rect" href="_setup_wizard_8cs.html#a8c25292615cd1ecad91305b36ea7068e" title="Prompts the user to create a ElasticsearchConfiguration." alt="" coords="307,55,461,80"/>
<area shape="rect" href="_setup_wizard_8cs.html#a8c8f5f56a7438fe48011eb8d738abec8" title="Prompts the user to create a GeneralConfiguration." alt="" coords="323,104,445,129"/>
<area shape="rect" href="_setup_wizard_8cs.html#adbd38b2960ebef44f65c5b8e0af409b0" title="Prompts the user to create a FileLoggingConfiguration." alt="" coords="323,153,445,179"/>
<area shape="rect" href="_setup_wizard_8cs.html#a159af60f0c66366ede5c65cb6e21e5ea" title="Prompts the user to create a SwarmConfiguration." alt="" coords="325,203,443,228"/>
<area shape="rect" href="_setup_wizard_8cs.html#afb6b6fca0a8f1d72dd4e4f5cc84f76f1" title="Saves a given Configuration set to userConfigFileName ." alt="" coords="321,252,447,277"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="_setup_wizard_8cs_aac16c05e965ab067e23152458aa6fe59_icgraph.png" border="0" usemap="#a_setup_wizard_8cs_aac16c05e965ab067e23152458aa6fe59_icgraph" alt=""/></div>
<map name="a_setup_wizard_8cs_aac16c05e965ab067e23152458aa6fe59_icgraph" id="a_setup_wizard_8cs_aac16c05e965ab067e23152458aa6fe59_icgraph">
<area shape="rect" title="Check if it should and run the SetupWizard if necessary." alt="" coords="241,13,363,38"/>
<area shape="rect" href="class_tgstation_1_1_server_1_1_host_1_1_setup_1_1_setup_wizard.html#aa7320ced82b10bda77125684f2708839" title=" " alt="" coords="5,5,193,45"/>
</map>
</div>

</div>
</div>
<a id="a46a4314202bbe55ae8724e7d27486163" name="a46a4314202bbe55ae8724e7d27486163"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a46a4314202bbe55ae8724e7d27486163">&#9670;&#160;</a></span>ConfigureControlPanel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">async Task&lt; <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_control_panel_configuration.html">ControlPanelConfiguration</a> &gt; ConfigureControlPanel </td>
          <td>(</td>
          <td class="paramtype">CancellationToken&#160;</td>
          <td class="paramname"><em>cancellationToken</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Prompts the user to create a ControlPanelConfiguration.  </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cancellationToken</td><td>The CancellationToken for the operation.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A Task&lt;TResult&gt; resulting in the new ControlPanelConfiguration.</dd></dl>

<p class="definition">Definition at line <a class="el" href="_setup_wizard_8cs_source.html#l00867">867</a> of file <a class="el" href="_setup_wizard_8cs_source.html">SetupWizard.cs</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  868</span>        {</div>
<div class="line"><span class="lineno">  869</span>            var config = <span class="keyword">new</span> <a class="code hl_class" href="class_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_control_panel_configuration.html">ControlPanelConfiguration</a></div>
<div class="line"><span class="lineno">  870</span>            {</div>
<div class="line"><span class="lineno">  871</span>                Enable = await PromptYesNo(<span class="stringliteral">&quot;Enable the web control panel?&quot;</span>, <span class="keyword">true</span>, cancellationToken),</div>
<div class="line"><span class="lineno">  872</span>                AllowAnyOrigin = await PromptYesNo(</div>
<div class="line"><span class="lineno">  873</span>                    <span class="stringliteral">&quot;Allow web control panels hosted elsewhere to access the server? (Access-Control-Allow-Origin: *)&quot;</span>,</div>
<div class="line"><span class="lineno">  874</span>                    <span class="keyword">true</span>,</div>
<div class="line"><span class="lineno">  875</span>                    cancellationToken),</div>
<div class="line"><span class="lineno">  876</span>            };</div>
<div class="line"><span class="lineno">  877</span> </div>
<div class="line"><span class="lineno">  878</span>            <span class="keywordflow">if</span> (!config.AllowAnyOrigin)</div>
<div class="line"><span class="lineno">  879</span>            {</div>
<div class="line"><span class="lineno">  880</span>                await console.WriteAsync(<span class="stringliteral">&quot;Enter a comma seperated list of CORS allowed origins (optional): &quot;</span>, <span class="keyword">false</span>, cancellationToken);</div>
<div class="line"><span class="lineno">  881</span>                var commaSeperatedOrigins = await console.ReadLineAsync(<span class="keyword">false</span>, cancellationToken);</div>
<div class="line"><span class="lineno">  882</span>                <span class="keywordflow">if</span> (!String.IsNullOrWhiteSpace(commaSeperatedOrigins))</div>
<div class="line"><span class="lineno">  883</span>                {</div>
<div class="line"><span class="lineno">  884</span>                    var splits = commaSeperatedOrigins.Split(<span class="charliteral">&#39;,&#39;</span>);</div>
<div class="line"><span class="lineno">  885</span>                    config.AllowedOrigins = <span class="keyword">new</span> List&lt;string&gt;(splits.Select(x =&gt; x.Trim()));</div>
<div class="line"><span class="lineno">  886</span>                }</div>
<div class="line"><span class="lineno">  887</span>            }</div>
<div class="line"><span class="lineno">  888</span> </div>
<div class="line"><span class="lineno">  889</span>            <span class="keywordflow">return</span> config;</div>
<div class="line"><span class="lineno">  890</span>        }</div>
<div class="ttc" id="aclass_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_control_panel_configuration_html"><div class="ttname"><a href="class_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_control_panel_configuration.html">Tgstation.Server.Host.Configuration.ControlPanelConfiguration</a></div><div class="ttdoc">Configuration options for the web control panel.</div><div class="ttdef"><b>Definition:</b> <a href="_control_panel_configuration_8cs_source.html#l00008">ControlPanelConfiguration.cs:9</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="_setup_wizard_8cs_source.html#l01056">RunWizard()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="_setup_wizard_8cs_a46a4314202bbe55ae8724e7d27486163_icgraph.png" border="0" usemap="#a_setup_wizard_8cs_a46a4314202bbe55ae8724e7d27486163_icgraph" alt=""/></div>
<map name="a_setup_wizard_8cs_a46a4314202bbe55ae8724e7d27486163_icgraph" id="a_setup_wizard_8cs_a46a4314202bbe55ae8724e7d27486163_icgraph">
<area shape="rect" title="Prompts the user to create a ControlPanelConfiguration." alt="" coords="543,13,693,38"/>
<area shape="rect" href="_setup_wizard_8cs.html#a133aa9167bebce98243748fe735a4e32" title="Runs the SetupWizard." alt="" coords="411,13,495,38"/>
<area shape="rect" href="_setup_wizard_8cs.html#aac16c05e965ab067e23152458aa6fe59" title="Check if it should and run the SetupWizard if necessary." alt="" coords="241,13,363,38"/>
<area shape="rect" href="class_tgstation_1_1_server_1_1_host_1_1_setup_1_1_setup_wizard.html#aa7320ced82b10bda77125684f2708839" title=" " alt="" coords="5,5,193,45"/>
</map>
</div>

</div>
</div>
<a id="a8c25292615cd1ecad91305b36ea7068e" name="a8c25292615cd1ecad91305b36ea7068e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8c25292615cd1ecad91305b36ea7068e">&#9670;&#160;</a></span>ConfigureElasticsearch()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">async Task&lt; <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_elasticsearch_configuration.html">ElasticsearchConfiguration</a> &gt; ConfigureElasticsearch </td>
          <td>(</td>
          <td class="paramtype">CancellationToken&#160;</td>
          <td class="paramname"><em>cancellationToken</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Prompts the user to create a ElasticsearchConfiguration.  </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cancellationToken</td><td>The CancellationToken for the operation.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A Task&lt;TResult&gt; resulting in the new ElasticsearchConfiguration.</dd></dl>

<p class="definition">Definition at line <a class="el" href="_setup_wizard_8cs_source.html#l00815">815</a> of file <a class="el" href="_setup_wizard_8cs_source.html">SetupWizard.cs</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  816</span>        {</div>
<div class="line"><span class="lineno">  817</span>            var elasticsearchConfiguration = <span class="keyword">new</span> <a class="code hl_class" href="class_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_elasticsearch_configuration.html">ElasticsearchConfiguration</a>();</div>
<div class="line"><span class="lineno">  818</span>            await console.WriteAsync(<span class="keyword">null</span>, <span class="keyword">true</span>, cancellationToken);</div>
<div class="line"><span class="lineno">  819</span>            elasticsearchConfiguration.Enable = await PromptYesNo(<span class="stringliteral">&quot;Enable logging to an external ElasticSearch server?&quot;</span>, <span class="keyword">false</span>, cancellationToken);</div>
<div class="line"><span class="lineno">  820</span> </div>
<div class="line"><span class="lineno">  821</span>            <span class="keywordflow">if</span> (elasticsearchConfiguration.Enable)</div>
<div class="line"><span class="lineno">  822</span>            {</div>
<div class="line"><span class="lineno">  823</span>                <span class="keywordflow">do</span></div>
<div class="line"><span class="lineno">  824</span>                {</div>
<div class="line"><span class="lineno">  825</span>                    await console.WriteAsync(<span class="stringliteral">&quot;ElasticSearch server endpoint (Include protocol and port, leave blank for http://127.0.0.1:9200): &quot;</span>, <span class="keyword">false</span>, cancellationToken);</div>
<div class="line"><span class="lineno">  826</span>                    var hostString = await console.ReadLineAsync(<span class="keyword">false</span>, cancellationToken);</div>
<div class="line"><span class="lineno">  827</span>                    <span class="keywordflow">if</span> (String.IsNullOrWhiteSpace(hostString))</div>
<div class="line"><span class="lineno">  828</span>                        hostString = <span class="stringliteral">&quot;http://127.0.0.1:9200&quot;</span>;</div>
<div class="line"><span class="lineno">  829</span> </div>
<div class="line"><span class="lineno">  830</span>                    <span class="keywordflow">if</span> (Uri.TryCreate(hostString, UriKind.Absolute, out var host))</div>
<div class="line"><span class="lineno">  831</span>                    {</div>
<div class="line"><span class="lineno">  832</span>                        elasticsearchConfiguration.Host = host;</div>
<div class="line"><span class="lineno">  833</span>                        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  834</span>                    }</div>
<div class="line"><span class="lineno">  835</span> </div>
<div class="line"><span class="lineno">  836</span>                    await console.WriteAsync(<span class="stringliteral">&quot;Invalid URI!&quot;</span>, <span class="keyword">true</span>, cancellationToken);</div>
<div class="line"><span class="lineno">  837</span>                }</div>
<div class="line"><span class="lineno">  838</span>                <span class="keywordflow">while</span> (<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  839</span> </div>
<div class="line"><span class="lineno">  840</span>                <span class="keywordflow">do</span></div>
<div class="line"><span class="lineno">  841</span>                {</div>
<div class="line"><span class="lineno">  842</span>                    await console.WriteAsync(<span class="stringliteral">&quot;Enter Elasticsearch username: &quot;</span>, <span class="keyword">false</span>, cancellationToken);</div>
<div class="line"><span class="lineno">  843</span>                    elasticsearchConfiguration.Username = await console.ReadLineAsync(<span class="keyword">false</span>, cancellationToken);</div>
<div class="line"><span class="lineno">  844</span>                    <span class="keywordflow">if</span> (!String.IsNullOrWhiteSpace(elasticsearchConfiguration.Username))</div>
<div class="line"><span class="lineno">  845</span>                        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  846</span>                }</div>
<div class="line"><span class="lineno">  847</span>                <span class="keywordflow">while</span> (<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  848</span> </div>
<div class="line"><span class="lineno">  849</span>                <span class="keywordflow">do</span></div>
<div class="line"><span class="lineno">  850</span>                {</div>
<div class="line"><span class="lineno">  851</span>                    await console.WriteAsync(<span class="stringliteral">&quot;Enter password: &quot;</span>, <span class="keyword">false</span>, cancellationToken);</div>
<div class="line"><span class="lineno">  852</span>                    elasticsearchConfiguration.Password = await console.ReadLineAsync(<span class="keyword">true</span>, cancellationToken);</div>
<div class="line"><span class="lineno">  853</span>                    <span class="keywordflow">if</span> (!String.IsNullOrWhiteSpace(elasticsearchConfiguration.Username))</div>
<div class="line"><span class="lineno">  854</span>                        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  855</span>                }</div>
<div class="line"><span class="lineno">  856</span>                <span class="keywordflow">while</span> (<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  857</span>            }</div>
<div class="line"><span class="lineno">  858</span> </div>
<div class="line"><span class="lineno">  859</span>            <span class="keywordflow">return</span> elasticsearchConfiguration;</div>
<div class="line"><span class="lineno">  860</span>        }</div>
<div class="ttc" id="aclass_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_elasticsearch_configuration_html"><div class="ttname"><a href="class_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_elasticsearch_configuration.html">Tgstation.Server.Host.Configuration.ElasticsearchConfiguration</a></div><div class="ttdoc">Configuration options pertaining to elasticsearch log storage.</div><div class="ttdef"><b>Definition:</b> <a href="_elasticsearch_configuration_8cs_source.html#l00008">ElasticsearchConfiguration.cs:9</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="_setup_wizard_8cs_source.html#l01056">RunWizard()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="_setup_wizard_8cs_a8c25292615cd1ecad91305b36ea7068e_icgraph.png" border="0" usemap="#a_setup_wizard_8cs_a8c25292615cd1ecad91305b36ea7068e_icgraph" alt=""/></div>
<map name="a_setup_wizard_8cs_a8c25292615cd1ecad91305b36ea7068e_icgraph" id="a_setup_wizard_8cs_a8c25292615cd1ecad91305b36ea7068e_icgraph">
<area shape="rect" title="Prompts the user to create a ElasticsearchConfiguration." alt="" coords="543,13,697,38"/>
<area shape="rect" href="_setup_wizard_8cs.html#a133aa9167bebce98243748fe735a4e32" title="Runs the SetupWizard." alt="" coords="411,13,495,38"/>
<area shape="rect" href="_setup_wizard_8cs.html#aac16c05e965ab067e23152458aa6fe59" title="Check if it should and run the SetupWizard if necessary." alt="" coords="241,13,363,38"/>
<area shape="rect" href="class_tgstation_1_1_server_1_1_host_1_1_setup_1_1_setup_wizard.html#aa7320ced82b10bda77125684f2708839" title=" " alt="" coords="5,5,193,45"/>
</map>
</div>

</div>
</div>
<a id="a8c8f5f56a7438fe48011eb8d738abec8" name="a8c8f5f56a7438fe48011eb8d738abec8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8c8f5f56a7438fe48011eb8d738abec8">&#9670;&#160;</a></span>ConfigureGeneral()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">async Task&lt; <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_general_configuration.html">GeneralConfiguration</a> &gt; ConfigureGeneral </td>
          <td>(</td>
          <td class="paramtype">CancellationToken&#160;</td>
          <td class="paramname"><em>cancellationToken</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Prompts the user to create a GeneralConfiguration.  </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cancellationToken</td><td>The CancellationToken for the operation.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A Task&lt;TResult&gt; resulting in the new GeneralConfiguration.</dd></dl>

<p class="definition">Definition at line <a class="el" href="_setup_wizard_8cs_source.html#l00672">672</a> of file <a class="el" href="_setup_wizard_8cs_source.html">SetupWizard.cs</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  673</span>        {</div>
<div class="line"><span class="lineno">  674</span>            var newGeneralConfiguration = <span class="keyword">new</span> <a class="code hl_class" href="class_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_general_configuration.html">GeneralConfiguration</a></div>
<div class="line"><span class="lineno">  675</span>            {</div>
<div class="line"><span class="lineno">  676</span>                <a class="code hl_enumeration" href="namespace_tgstation_1_1_server_1_1_host_1_1_setup.html#ada83b66b0eb589bb855302d25c41e4de">SetupWizardMode</a> = <a class="code hl_enumeration" href="namespace_tgstation_1_1_server_1_1_host_1_1_setup.html#ada83b66b0eb589bb855302d25c41e4de">SetupWizardMode</a>.Never,</div>
<div class="line"><span class="lineno">  677</span>            };</div>
<div class="line"><span class="lineno">  678</span> </div>
<div class="line"><span class="lineno">  679</span>            <span class="keywordflow">do</span></div>
<div class="line"><span class="lineno">  680</span>            {</div>
<div class="line"><span class="lineno">  681</span>                await console.WriteAsync(<span class="keyword">null</span>, <span class="keyword">true</span>, cancellationToken);</div>
<div class="line"><span class="lineno">  682</span>                await console.WriteAsync(String.Format(CultureInfo.InvariantCulture, <span class="stringliteral">&quot;Minimum database user password length (leave blank for default of {0}): &quot;</span>, newGeneralConfiguration.MinimumPasswordLength), <span class="keyword">false</span>, cancellationToken);</div>
<div class="line"><span class="lineno">  683</span>                var passwordLengthString = await console.ReadLineAsync(<span class="keyword">false</span>, cancellationToken);</div>
<div class="line"><span class="lineno">  684</span>                <span class="keywordflow">if</span> (String.IsNullOrWhiteSpace(passwordLengthString))</div>
<div class="line"><span class="lineno">  685</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  686</span>                <span class="keywordflow">if</span> (UInt32.TryParse(passwordLengthString, out var passwordLength) &amp;&amp; passwordLength &gt;= 0)</div>
<div class="line"><span class="lineno">  687</span>                {</div>
<div class="line"><span class="lineno">  688</span>                    newGeneralConfiguration.MinimumPasswordLength = passwordLength;</div>
<div class="line"><span class="lineno">  689</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  690</span>                }</div>
<div class="line"><span class="lineno">  691</span> </div>
<div class="line"><span class="lineno">  692</span>                await console.WriteAsync(<span class="stringliteral">&quot;Please enter a positive integer!&quot;</span>, <span class="keyword">true</span>, cancellationToken);</div>
<div class="line"><span class="lineno">  693</span>            }</div>
<div class="line"><span class="lineno">  694</span>            <span class="keywordflow">while</span> (<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  695</span> </div>
<div class="line"><span class="lineno">  696</span>            <span class="keywordflow">do</span></div>
<div class="line"><span class="lineno">  697</span>            {</div>
<div class="line"><span class="lineno">  698</span>                await console.WriteAsync(<span class="keyword">null</span>, <span class="keyword">true</span>, cancellationToken);</div>
<div class="line"><span class="lineno">  699</span>                await console.WriteAsync(String.Format(CultureInfo.InvariantCulture, <span class="stringliteral">&quot;Default timeout for sending and receiving BYOND topics (ms, 0 for infinite, leave blank for default of {0}): &quot;</span>, newGeneralConfiguration.ByondTopicTimeout), <span class="keyword">false</span>, cancellationToken);</div>
<div class="line"><span class="lineno">  700</span>                var topicTimeoutString = await console.ReadLineAsync(<span class="keyword">false</span>, cancellationToken);</div>
<div class="line"><span class="lineno">  701</span>                <span class="keywordflow">if</span> (String.IsNullOrWhiteSpace(topicTimeoutString))</div>
<div class="line"><span class="lineno">  702</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  703</span>                <span class="keywordflow">if</span> (UInt32.TryParse(topicTimeoutString, out var topicTimeout) &amp;&amp; topicTimeout &gt;= 0)</div>
<div class="line"><span class="lineno">  704</span>                {</div>
<div class="line"><span class="lineno">  705</span>                    newGeneralConfiguration.ByondTopicTimeout = topicTimeout;</div>
<div class="line"><span class="lineno">  706</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  707</span>                }</div>
<div class="line"><span class="lineno">  708</span> </div>
<div class="line"><span class="lineno">  709</span>                await console.WriteAsync(<span class="stringliteral">&quot;Please enter a positive integer!&quot;</span>, <span class="keyword">true</span>, cancellationToken);</div>
<div class="line"><span class="lineno">  710</span>            }</div>
<div class="line"><span class="lineno">  711</span>            <span class="keywordflow">while</span> (<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  712</span> </div>
<div class="line"><span class="lineno">  713</span>            await console.WriteAsync(<span class="keyword">null</span>, <span class="keyword">true</span>, cancellationToken);</div>
<div class="line"><span class="lineno">  714</span>            await console.WriteAsync(<span class="stringliteral">&quot;Enter a GitHub personal access token to bypass some rate limits (this is optional and does not require any scopes)&quot;</span>, <span class="keyword">true</span>, cancellationToken);</div>
<div class="line"><span class="lineno">  715</span>            await console.WriteAsync(<span class="stringliteral">&quot;GitHub personal access token: &quot;</span>, <span class="keyword">false</span>, cancellationToken);</div>
<div class="line"><span class="lineno">  716</span>            newGeneralConfiguration.GitHubAccessToken = await console.ReadLineAsync(<span class="keyword">true</span>, cancellationToken);</div>
<div class="line"><span class="lineno">  717</span>            <span class="keywordflow">if</span> (String.IsNullOrWhiteSpace(newGeneralConfiguration.GitHubAccessToken))</div>
<div class="line"><span class="lineno">  718</span>                newGeneralConfiguration.GitHubAccessToken = <span class="keyword">null</span>;</div>
<div class="line"><span class="lineno">  719</span> </div>
<div class="line"><span class="lineno">  720</span>            newGeneralConfiguration.HostApiDocumentation = await PromptYesNo(<span class="stringliteral">&quot;Host API Documentation?&quot;</span>, <span class="keyword">false</span>, cancellationToken);</div>
<div class="line"><span class="lineno">  721</span> </div>
<div class="line"><span class="lineno">  722</span>            <span class="keywordflow">return</span> newGeneralConfiguration;</div>
<div class="line"><span class="lineno">  723</span>        }</div>
<div class="ttc" id="aclass_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_general_configuration_html"><div class="ttname"><a href="class_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_general_configuration.html">Tgstation.Server.Host.Configuration.GeneralConfiguration</a></div><div class="ttdoc">General configuration options.</div><div class="ttdef"><b>Definition:</b> <a href="_general_configuration_8cs_source.html#l00017">GeneralConfiguration.cs:18</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="_setup_wizard_8cs_source.html#l01056">RunWizard()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="_setup_wizard_8cs_a8c8f5f56a7438fe48011eb8d738abec8_icgraph.png" border="0" usemap="#a_setup_wizard_8cs_a8c8f5f56a7438fe48011eb8d738abec8_icgraph" alt=""/></div>
<map name="a_setup_wizard_8cs_a8c8f5f56a7438fe48011eb8d738abec8_icgraph" id="a_setup_wizard_8cs_a8c8f5f56a7438fe48011eb8d738abec8_icgraph">
<area shape="rect" title="Prompts the user to create a GeneralConfiguration." alt="" coords="543,13,664,38"/>
<area shape="rect" href="_setup_wizard_8cs.html#a133aa9167bebce98243748fe735a4e32" title="Runs the SetupWizard." alt="" coords="411,13,495,38"/>
<area shape="rect" href="_setup_wizard_8cs.html#aac16c05e965ab067e23152458aa6fe59" title="Check if it should and run the SetupWizard if necessary." alt="" coords="241,13,363,38"/>
<area shape="rect" href="class_tgstation_1_1_server_1_1_host_1_1_setup_1_1_setup_wizard.html#aa7320ced82b10bda77125684f2708839" title=" " alt="" coords="5,5,193,45"/>
</map>
</div>

</div>
</div>
<a id="adbd38b2960ebef44f65c5b8e0af409b0" name="adbd38b2960ebef44f65c5b8e0af409b0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adbd38b2960ebef44f65c5b8e0af409b0">&#9670;&#160;</a></span>ConfigureLogging()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">async Task&lt; <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_file_logging_configuration.html">FileLoggingConfiguration</a> &gt; ConfigureLogging </td>
          <td>(</td>
          <td class="paramtype">CancellationToken&#160;</td>
          <td class="paramname"><em>cancellationToken</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Prompts the user to create a FileLoggingConfiguration.  </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cancellationToken</td><td>The CancellationToken for the operation.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A Task&lt;TResult&gt; resulting in the new FileLoggingConfiguration.</dd></dl>

<p class="definition">Definition at line <a class="el" href="_setup_wizard_8cs_source.html#l00730">730</a> of file <a class="el" href="_setup_wizard_8cs_source.html">SetupWizard.cs</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  731</span>        {</div>
<div class="line"><span class="lineno">  732</span>            var fileLoggingConfiguration = <span class="keyword">new</span> <a class="code hl_class" href="class_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_file_logging_configuration.html">FileLoggingConfiguration</a>();</div>
<div class="line"><span class="lineno">  733</span>            await console.WriteAsync(<span class="keyword">null</span>, <span class="keyword">true</span>, cancellationToken);</div>
<div class="line"><span class="lineno">  734</span>            fileLoggingConfiguration.Disable = !await PromptYesNo(<span class="stringliteral">&quot;Enable file logging?&quot;</span>, <span class="keyword">true</span>, cancellationToken);</div>
<div class="line"><span class="lineno">  735</span> </div>
<div class="line"><span class="lineno">  736</span>            <span class="keywordflow">if</span> (!fileLoggingConfiguration.Disable)</div>
<div class="line"><span class="lineno">  737</span>            {</div>
<div class="line"><span class="lineno">  738</span>                <span class="keywordflow">do</span></div>
<div class="line"><span class="lineno">  739</span>                {</div>
<div class="line"><span class="lineno">  740</span>                    await console.WriteAsync(<span class="stringliteral">&quot;Log file directory path (leave blank for default): &quot;</span>, <span class="keyword">false</span>, cancellationToken);</div>
<div class="line"><span class="lineno">  741</span>                    fileLoggingConfiguration.Directory = await console.ReadLineAsync(<span class="keyword">false</span>, cancellationToken);</div>
<div class="line"><span class="lineno">  742</span>                    <span class="keywordflow">if</span> (String.IsNullOrWhiteSpace(fileLoggingConfiguration.Directory))</div>
<div class="line"><span class="lineno">  743</span>                    {</div>
<div class="line"><span class="lineno">  744</span>                        fileLoggingConfiguration.Directory = <span class="keyword">null</span>;</div>
<div class="line"><span class="lineno">  745</span>                        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  746</span>                    }</div>
<div class="line"><span class="lineno">  747</span> </div>
<div class="line"><span class="lineno">  748</span>                    <span class="comment">// test a write of it</span></div>
<div class="line"><span class="lineno">  749</span>                    await console.WriteAsync(<span class="keyword">null</span>, <span class="keyword">true</span>, cancellationToken);</div>
<div class="line"><span class="lineno">  750</span>                    await console.WriteAsync(<span class="stringliteral">&quot;Testing directory access...&quot;</span>, <span class="keyword">true</span>, cancellationToken);</div>
<div class="line"><span class="lineno">  751</span>                    <span class="keywordflow">try</span></div>
<div class="line"><span class="lineno">  752</span>                    {</div>
<div class="line"><span class="lineno">  753</span>                        await ioManager.CreateDirectory(fileLoggingConfiguration.Directory, cancellationToken);</div>
<div class="line"><span class="lineno">  754</span>                        var testFile = ioManager.ConcatPath(fileLoggingConfiguration.Directory, String.Format(CultureInfo.InvariantCulture, <span class="stringliteral">&quot;WizardAccesTest.{0}.deleteme&quot;</span>, Guid.NewGuid()));</div>
<div class="line"><span class="lineno">  755</span>                        await ioManager.WriteAllBytes(testFile, Array.Empty&lt;<span class="keywordtype">byte</span>&gt;(), cancellationToken);</div>
<div class="line"><span class="lineno">  756</span>                        <span class="keywordflow">try</span></div>
<div class="line"><span class="lineno">  757</span>                        {</div>
<div class="line"><span class="lineno">  758</span>                            await ioManager.DeleteFile(testFile, cancellationToken);</div>
<div class="line"><span class="lineno">  759</span>                        }</div>
<div class="line"><span class="lineno">  760</span>                        <span class="keywordflow">catch</span> (OperationCanceledException)</div>
<div class="line"><span class="lineno">  761</span>                        {</div>
<div class="line"><span class="lineno">  762</span>                            <span class="keywordflow">throw</span>;</div>
<div class="line"><span class="lineno">  763</span>                        }</div>
<div class="line"><span class="lineno">  764</span>                        <span class="keywordflow">catch</span> (Exception e)</div>
<div class="line"><span class="lineno">  765</span>                        {</div>
<div class="line"><span class="lineno">  766</span>                            await console.WriteAsync(String.Format(CultureInfo.InvariantCulture, <span class="stringliteral">&quot;Error deleting test log file: {0}&quot;</span>, testFile), <span class="keyword">true</span>, cancellationToken);</div>
<div class="line"><span class="lineno">  767</span>                            await console.WriteAsync(e.Message, <span class="keyword">true</span>, cancellationToken);</div>
<div class="line"><span class="lineno">  768</span>                            await console.WriteAsync(<span class="keyword">null</span>, <span class="keyword">true</span>, cancellationToken);</div>
<div class="line"><span class="lineno">  769</span>                        }</div>
<div class="line"><span class="lineno">  770</span> </div>
<div class="line"><span class="lineno">  771</span>                        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  772</span>                    }</div>
<div class="line"><span class="lineno">  773</span>                    <span class="keywordflow">catch</span> (OperationCanceledException)</div>
<div class="line"><span class="lineno">  774</span>                    {</div>
<div class="line"><span class="lineno">  775</span>                        <span class="keywordflow">throw</span>;</div>
<div class="line"><span class="lineno">  776</span>                    }</div>
<div class="line"><span class="lineno">  777</span>                    <span class="keywordflow">catch</span> (Exception e)</div>
<div class="line"><span class="lineno">  778</span>                    {</div>
<div class="line"><span class="lineno">  779</span>                        await console.WriteAsync(e.Message, <span class="keyword">true</span>, cancellationToken);</div>
<div class="line"><span class="lineno">  780</span>                        await console.WriteAsync(<span class="keyword">null</span>, <span class="keyword">true</span>, cancellationToken);</div>
<div class="line"><span class="lineno">  781</span>                        await console.WriteAsync(<span class="stringliteral">&quot;Please verify the path is valid and you have access to it!&quot;</span>, <span class="keyword">true</span>, cancellationToken);</div>
<div class="line"><span class="lineno">  782</span>                    }</div>
<div class="line"><span class="lineno">  783</span>                }</div>
<div class="line"><span class="lineno">  784</span>                <span class="keywordflow">while</span> (<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  785</span> </div>
<div class="line"><span class="lineno">  786</span>                async Task&lt;LogLevel?&gt; PromptLogLevel(<span class="keywordtype">string</span> question)</div>
<div class="line"><span class="lineno">  787</span>                {</div>
<div class="line"><span class="lineno">  788</span>                    <span class="keywordflow">do</span></div>
<div class="line"><span class="lineno">  789</span>                    {</div>
<div class="line"><span class="lineno">  790</span>                        await console.WriteAsync(<span class="keyword">null</span>, <span class="keyword">true</span>, cancellationToken);</div>
<div class="line"><span class="lineno">  791</span>                        await console.WriteAsync(question, <span class="keyword">true</span>, cancellationToken);</div>
<div class="line"><span class="lineno">  792</span>                        await console.WriteAsync(String.Format(CultureInfo.InvariantCulture, <span class="stringliteral">&quot;Enter one of {0}/{1}/{2}/{3}/{4}/{5} (leave blank for default): &quot;</span>, nameof(LogLevel.Trace), nameof(LogLevel.Debug), nameof(LogLevel.Information), nameof(LogLevel.Warning), nameof(LogLevel.Error), nameof(LogLevel.Critical)), <span class="keyword">false</span>, cancellationToken);</div>
<div class="line"><span class="lineno">  793</span>                        var responseString = await console.ReadLineAsync(<span class="keyword">false</span>, cancellationToken);</div>
<div class="line"><span class="lineno">  794</span>                        <span class="keywordflow">if</span> (String.IsNullOrWhiteSpace(responseString))</div>
<div class="line"><span class="lineno">  795</span>                            <span class="keywordflow">return</span> <span class="keyword">null</span>;</div>
<div class="line"><span class="lineno">  796</span>                        <span class="keywordflow">if</span> (Enum.TryParse&lt;LogLevel&gt;(responseString, out var logLevel) &amp;&amp; logLevel != LogLevel.None)</div>
<div class="line"><span class="lineno">  797</span>                            <span class="keywordflow">return</span> logLevel;</div>
<div class="line"><span class="lineno">  798</span>                        await console.WriteAsync(<span class="stringliteral">&quot;Invalid log level!&quot;</span>, <span class="keyword">true</span>, cancellationToken);</div>
<div class="line"><span class="lineno">  799</span>                    }</div>
<div class="line"><span class="lineno">  800</span>                    <span class="keywordflow">while</span> (<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  801</span>                }</div>
<div class="line"><span class="lineno">  802</span> </div>
<div class="line"><span class="lineno">  803</span>                fileLoggingConfiguration.LogLevel = await PromptLogLevel(String.Format(CultureInfo.InvariantCulture, <span class="stringliteral">&quot;Enter the level limit for normal logs (default {0}).&quot;</span>, fileLoggingConfiguration.LogLevel)) ?? fileLoggingConfiguration.LogLevel;</div>
<div class="line"><span class="lineno">  804</span>                fileLoggingConfiguration.MicrosoftLogLevel = await PromptLogLevel(String.Format(CultureInfo.InvariantCulture, <span class="stringliteral">&quot;Enter the level limit for Microsoft logs (VERY verbose, default {0}).&quot;</span>, fileLoggingConfiguration.MicrosoftLogLevel)) ?? fileLoggingConfiguration.MicrosoftLogLevel;</div>
<div class="line"><span class="lineno">  805</span>            }</div>
<div class="line"><span class="lineno">  806</span> </div>
<div class="line"><span class="lineno">  807</span>            <span class="keywordflow">return</span> fileLoggingConfiguration;</div>
<div class="line"><span class="lineno">  808</span>        }</div>
<div class="ttc" id="aclass_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_file_logging_configuration_html"><div class="ttname"><a href="class_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_file_logging_configuration.html">Tgstation.Server.Host.Configuration.FileLoggingConfiguration</a></div><div class="ttdoc">File logging configuration options.</div><div class="ttdef"><b>Definition:</b> <a href="_file_logging_configuration_8cs_source.html#l00015">FileLoggingConfiguration.cs:16</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="_setup_wizard_8cs_source.html#l01056">RunWizard()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="_setup_wizard_8cs_adbd38b2960ebef44f65c5b8e0af409b0_icgraph.png" border="0" usemap="#a_setup_wizard_8cs_adbd38b2960ebef44f65c5b8e0af409b0_icgraph" alt=""/></div>
<map name="a_setup_wizard_8cs_adbd38b2960ebef44f65c5b8e0af409b0_icgraph" id="a_setup_wizard_8cs_adbd38b2960ebef44f65c5b8e0af409b0_icgraph">
<area shape="rect" title="Prompts the user to create a FileLoggingConfiguration." alt="" coords="543,13,665,38"/>
<area shape="rect" href="_setup_wizard_8cs.html#a133aa9167bebce98243748fe735a4e32" title="Runs the SetupWizard." alt="" coords="411,13,495,38"/>
<area shape="rect" href="_setup_wizard_8cs.html#aac16c05e965ab067e23152458aa6fe59" title="Check if it should and run the SetupWizard if necessary." alt="" coords="241,13,363,38"/>
<area shape="rect" href="class_tgstation_1_1_server_1_1_host_1_1_setup_1_1_setup_wizard.html#aa7320ced82b10bda77125684f2708839" title=" " alt="" coords="5,5,193,45"/>
</map>
</div>

</div>
</div>
<a id="a159af60f0c66366ede5c65cb6e21e5ea" name="a159af60f0c66366ede5c65cb6e21e5ea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a159af60f0c66366ede5c65cb6e21e5ea">&#9670;&#160;</a></span>ConfigureSwarm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">async Task&lt; <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_swarm_configuration.html">SwarmConfiguration</a> &gt; ConfigureSwarm </td>
          <td>(</td>
          <td class="paramtype">CancellationToken&#160;</td>
          <td class="paramname"><em>cancellationToken</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Prompts the user to create a SwarmConfiguration.  </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cancellationToken</td><td>The CancellationToken for the operation.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A Task&lt;TResult&gt; resulting in the new SwarmConfiguration.</dd></dl>

<p class="definition">Definition at line <a class="el" href="_setup_wizard_8cs_source.html#l00897">897</a> of file <a class="el" href="_setup_wizard_8cs_source.html">SetupWizard.cs</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  898</span>        {</div>
<div class="line"><span class="lineno">  899</span>            var enable = await PromptYesNo(<span class="stringliteral">&quot;Enable swarm mode?&quot;</span>, <span class="keyword">false</span>, cancellationToken);</div>
<div class="line"><span class="lineno">  900</span>            <span class="keywordflow">if</span> (!enable)</div>
<div class="line"><span class="lineno">  901</span>                <span class="keywordflow">return</span> <span class="keyword">null</span>;</div>
<div class="line"><span class="lineno">  902</span> </div>
<div class="line"><span class="lineno">  903</span>            <span class="keywordtype">string</span> identifer;</div>
<div class="line"><span class="lineno">  904</span>            <span class="keywordflow">do</span></div>
<div class="line"><span class="lineno">  905</span>            {</div>
<div class="line"><span class="lineno">  906</span>                await console.WriteAsync(<span class="stringliteral">&quot;Enter this server&#39;s identifer: &quot;</span>, <span class="keyword">false</span>, cancellationToken);</div>
<div class="line"><span class="lineno">  907</span>                identifer = await console.ReadLineAsync(<span class="keyword">false</span>, cancellationToken);</div>
<div class="line"><span class="lineno">  908</span>            }</div>
<div class="line"><span class="lineno">  909</span>            <span class="keywordflow">while</span> (String.IsNullOrWhiteSpace(identifer));</div>
<div class="line"><span class="lineno">  910</span> </div>
<div class="line"><span class="lineno">  911</span>            async Task&lt;Uri&gt; ParseAddress(<span class="keywordtype">string</span> question)</div>
<div class="line"><span class="lineno">  912</span>            {</div>
<div class="line"><span class="lineno">  913</span>                var first = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  914</span>                Uri address;</div>
<div class="line"><span class="lineno">  915</span>                <span class="keywordflow">do</span></div>
<div class="line"><span class="lineno">  916</span>                {</div>
<div class="line"><span class="lineno">  917</span>                    <span class="keywordflow">if</span> (first)</div>
<div class="line"><span class="lineno">  918</span>                        first = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  919</span>                    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  920</span>                        await console.WriteAsync(<span class="stringliteral">&quot;Invalid address!&quot;</span>, <span class="keyword">true</span>, cancellationToken);</div>
<div class="line"><span class="lineno">  921</span> </div>
<div class="line"><span class="lineno">  922</span>                    await console.WriteAsync(question, <span class="keyword">false</span>, cancellationToken);</div>
<div class="line"><span class="lineno">  923</span>                    var addressString = await console.ReadLineAsync(<span class="keyword">false</span>, cancellationToken);</div>
<div class="line"><span class="lineno">  924</span>                    <span class="keywordflow">if</span> (Uri.TryCreate(addressString, UriKind.Absolute, out address)</div>
<div class="line"><span class="lineno">  925</span>                        &amp;&amp; address.Scheme != Uri.UriSchemeHttp</div>
<div class="line"><span class="lineno">  926</span>                        &amp;&amp; address.Scheme != Uri.UriSchemeHttps)</div>
<div class="line"><span class="lineno">  927</span>                        address = <span class="keyword">null</span>;</div>
<div class="line"><span class="lineno">  928</span>                }</div>
<div class="line"><span class="lineno">  929</span>                <span class="keywordflow">while</span> (address == <span class="keyword">null</span>);</div>
<div class="line"><span class="lineno">  930</span> </div>
<div class="line"><span class="lineno">  931</span>                <span class="keywordflow">return</span> address;</div>
<div class="line"><span class="lineno">  932</span>            }</div>
<div class="line"><span class="lineno">  933</span> </div>
<div class="line"><span class="lineno">  934</span>            var address = await ParseAddress(<span class="stringliteral">&quot;Enter this server&#39;s INTERNAL http(s) address: &quot;</span>);</div>
<div class="line"><span class="lineno">  935</span>            var publicAddress = await ParseAddress(<span class="stringliteral">&quot;Enter this server&#39;s PUBLIC https(s) address: &quot;</span>);</div>
<div class="line"><span class="lineno">  936</span>            <span class="keywordtype">string</span> privateKey;</div>
<div class="line"><span class="lineno">  937</span>            <span class="keywordflow">do</span></div>
<div class="line"><span class="lineno">  938</span>            {</div>
<div class="line"><span class="lineno">  939</span>                await console.WriteAsync(<span class="stringliteral">&quot;Enter the swarm private key: &quot;</span>, <span class="keyword">false</span>, cancellationToken);</div>
<div class="line"><span class="lineno">  940</span>                privateKey = await console.ReadLineAsync(<span class="keyword">false</span>, cancellationToken);</div>
<div class="line"><span class="lineno">  941</span>            }</div>
<div class="line"><span class="lineno">  942</span>            <span class="keywordflow">while</span> (String.IsNullOrWhiteSpace(privateKey));</div>
<div class="line"><span class="lineno">  943</span> </div>
<div class="line"><span class="lineno">  944</span>            var controller = await PromptYesNo(<span class="stringliteral">&quot;Is this server the swarm&#39;s controller? (y/n): &quot;</span>, <span class="keyword">null</span>, cancellationToken);</div>
<div class="line"><span class="lineno">  945</span>            Uri controllerAddress = <span class="keyword">null</span>;</div>
<div class="line"><span class="lineno">  946</span>            <span class="keywordflow">if</span> (!controller)</div>
<div class="line"><span class="lineno">  947</span>                controllerAddress = await ParseAddress(<span class="stringliteral">&quot;Enter the swarm controller&#39;s HTTP(S) address: &quot;</span>);</div>
<div class="line"><span class="lineno">  948</span> </div>
<div class="line"><span class="lineno">  949</span>            <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code hl_class" href="class_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_swarm_configuration.html">SwarmConfiguration</a></div>
<div class="line"><span class="lineno">  950</span>            {</div>
<div class="line"><span class="lineno">  951</span>                Address = address,</div>
<div class="line"><span class="lineno">  952</span>                PublicAddress = publicAddress,</div>
<div class="line"><span class="lineno">  953</span>                ControllerAddress = controllerAddress,</div>
<div class="line"><span class="lineno">  954</span>                Identifier = identifer,</div>
<div class="line"><span class="lineno">  955</span>                PrivateKey = privateKey,</div>
<div class="line"><span class="lineno">  956</span>            };</div>
<div class="line"><span class="lineno">  957</span>        }</div>
<div class="ttc" id="aclass_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_swarm_configuration_html"><div class="ttname"><a href="class_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_swarm_configuration.html">Tgstation.Server.Host.Configuration.SwarmConfiguration</a></div><div class="ttdoc">Configuration for the server swarm system.</div><div class="ttdef"><b>Definition:</b> <a href="_swarm_configuration_8cs_source.html#l00011">SwarmConfiguration.cs:12</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="_setup_wizard_8cs_source.html#l01056">RunWizard()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="_setup_wizard_8cs_a159af60f0c66366ede5c65cb6e21e5ea_icgraph.png" border="0" usemap="#a_setup_wizard_8cs_a159af60f0c66366ede5c65cb6e21e5ea_icgraph" alt=""/></div>
<map name="a_setup_wizard_8cs_a159af60f0c66366ede5c65cb6e21e5ea_icgraph" id="a_setup_wizard_8cs_a159af60f0c66366ede5c65cb6e21e5ea_icgraph">
<area shape="rect" title="Prompts the user to create a SwarmConfiguration." alt="" coords="543,13,660,38"/>
<area shape="rect" href="_setup_wizard_8cs.html#a133aa9167bebce98243748fe735a4e32" title="Runs the SetupWizard." alt="" coords="411,13,495,38"/>
<area shape="rect" href="_setup_wizard_8cs.html#aac16c05e965ab067e23152458aa6fe59" title="Check if it should and run the SetupWizard if necessary." alt="" coords="241,13,363,38"/>
<area shape="rect" href="class_tgstation_1_1_server_1_1_host_1_1_setup_1_1_setup_wizard.html#aa7320ced82b10bda77125684f2708839" title=" " alt="" coords="5,5,193,45"/>
</map>
</div>

</div>
</div>
<a id="a133aa9167bebce98243748fe735a4e32" name="a133aa9167bebce98243748fe735a4e32"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a133aa9167bebce98243748fe735a4e32">&#9670;&#160;</a></span>RunWizard()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">async Task RunWizard </td>
          <td>(</td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>userConfigFileName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CancellationToken&#160;</td>
          <td class="paramname"><em>cancellationToken</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Runs the SetupWizard.  </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">userConfigFileName</td><td>The path to the settings json to build.</td></tr>
    <tr><td class="paramname">cancellationToken</td><td>The CancellationToken for the operation.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A Task representing the running operation.</dd></dl>

<p class="definition">Definition at line <a class="el" href="_setup_wizard_8cs_source.html#l01056">1056</a> of file <a class="el" href="_setup_wizard_8cs_source.html">SetupWizard.cs</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1057</span>        {</div>
<div class="line"><span class="lineno"> 1058</span>            <span class="comment">// welcome message</span></div>
<div class="line"><span class="lineno"> 1059</span>            await console.WriteAsync($<span class="stringliteral">&quot;Welcome to {Constants.CanonicalPackageName}!&quot;</span>, <span class="keyword">true</span>, cancellationToken);</div>
<div class="line"><span class="lineno"> 1060</span>            await console.WriteAsync(<span class="stringliteral">&quot;This wizard will help you configure your server.&quot;</span>, <span class="keyword">true</span>, cancellationToken);</div>
<div class="line"><span class="lineno"> 1061</span> </div>
<div class="line"><span class="lineno"> 1062</span>            var hostingPort = await PromptForHostingPort(cancellationToken);</div>
<div class="line"><span class="lineno"> 1063</span> </div>
<div class="line"><span class="lineno"> 1064</span>            var databaseConfiguration = await ConfigureDatabase(cancellationToken);</div>
<div class="line"><span class="lineno"> 1065</span> </div>
<div class="line"><span class="lineno"> 1066</span>            var newGeneralConfiguration = await <a class="code hl_function" href="_setup_wizard_8cs.html#a8c8f5f56a7438fe48011eb8d738abec8">ConfigureGeneral</a>(cancellationToken);</div>
<div class="line"><span class="lineno"> 1067</span> </div>
<div class="line"><span class="lineno"> 1068</span>            var fileLoggingConfiguration = await <a class="code hl_function" href="_setup_wizard_8cs.html#adbd38b2960ebef44f65c5b8e0af409b0">ConfigureLogging</a>(cancellationToken);</div>
<div class="line"><span class="lineno"> 1069</span> </div>
<div class="line"><span class="lineno"> 1070</span>            var elasticSearchConfiguration = await <a class="code hl_function" href="_setup_wizard_8cs.html#a8c25292615cd1ecad91305b36ea7068e">ConfigureElasticsearch</a>(cancellationToken);</div>
<div class="line"><span class="lineno"> 1071</span> </div>
<div class="line"><span class="lineno"> 1072</span>            var controlPanelConfiguration = await <a class="code hl_function" href="_setup_wizard_8cs.html#a46a4314202bbe55ae8724e7d27486163">ConfigureControlPanel</a>(cancellationToken);</div>
<div class="line"><span class="lineno"> 1073</span> </div>
<div class="line"><span class="lineno"> 1074</span>            var swarmConfiguration = await <a class="code hl_function" href="_setup_wizard_8cs.html#a159af60f0c66366ede5c65cb6e21e5ea">ConfigureSwarm</a>(cancellationToken);</div>
<div class="line"><span class="lineno"> 1075</span> </div>
<div class="line"><span class="lineno"> 1076</span>            await console.WriteAsync(<span class="keyword">null</span>, <span class="keyword">true</span>, cancellationToken);</div>
<div class="line"><span class="lineno"> 1077</span> </div>
<div class="line"><span class="lineno"> 1078</span>            await <a class="code hl_function" href="_setup_wizard_8cs.html#afb6b6fca0a8f1d72dd4e4f5cc84f76f1">SaveConfiguration</a>(</div>
<div class="line"><span class="lineno"> 1079</span>                userConfigFileName,</div>
<div class="line"><span class="lineno"> 1080</span>                hostingPort,</div>
<div class="line"><span class="lineno"> 1081</span>                databaseConfiguration,</div>
<div class="line"><span class="lineno"> 1082</span>                newGeneralConfiguration,</div>
<div class="line"><span class="lineno"> 1083</span>                fileLoggingConfiguration,</div>
<div class="line"><span class="lineno"> 1084</span>                elasticSearchConfiguration,</div>
<div class="line"><span class="lineno"> 1085</span>                controlPanelConfiguration,</div>
<div class="line"><span class="lineno"> 1086</span>                swarmConfiguration,</div>
<div class="line"><span class="lineno"> 1087</span>                cancellationToken);</div>
<div class="line"><span class="lineno"> 1088</span>        }</div>
<div class="ttc" id="a_setup_wizard_8cs_html_a159af60f0c66366ede5c65cb6e21e5ea"><div class="ttname"><a href="_setup_wizard_8cs.html#a159af60f0c66366ede5c65cb6e21e5ea">ConfigureSwarm</a></div><div class="ttdeci">async Task&lt; SwarmConfiguration &gt; ConfigureSwarm(CancellationToken cancellationToken)</div><div class="ttdoc">Prompts the user to create a SwarmConfiguration.</div><div class="ttdef"><b>Definition:</b> <a href="_setup_wizard_8cs_source.html#l00897">SetupWizard.cs:897</a></div></div>
<div class="ttc" id="a_setup_wizard_8cs_html_a46a4314202bbe55ae8724e7d27486163"><div class="ttname"><a href="_setup_wizard_8cs.html#a46a4314202bbe55ae8724e7d27486163">ConfigureControlPanel</a></div><div class="ttdeci">async Task&lt; ControlPanelConfiguration &gt; ConfigureControlPanel(CancellationToken cancellationToken)</div><div class="ttdoc">Prompts the user to create a ControlPanelConfiguration.</div><div class="ttdef"><b>Definition:</b> <a href="_setup_wizard_8cs_source.html#l00867">SetupWizard.cs:867</a></div></div>
<div class="ttc" id="a_setup_wizard_8cs_html_a8c25292615cd1ecad91305b36ea7068e"><div class="ttname"><a href="_setup_wizard_8cs.html#a8c25292615cd1ecad91305b36ea7068e">ConfigureElasticsearch</a></div><div class="ttdeci">async Task&lt; ElasticsearchConfiguration &gt; ConfigureElasticsearch(CancellationToken cancellationToken)</div><div class="ttdoc">Prompts the user to create a ElasticsearchConfiguration.</div><div class="ttdef"><b>Definition:</b> <a href="_setup_wizard_8cs_source.html#l00815">SetupWizard.cs:815</a></div></div>
<div class="ttc" id="a_setup_wizard_8cs_html_a8c8f5f56a7438fe48011eb8d738abec8"><div class="ttname"><a href="_setup_wizard_8cs.html#a8c8f5f56a7438fe48011eb8d738abec8">ConfigureGeneral</a></div><div class="ttdeci">async Task&lt; GeneralConfiguration &gt; ConfigureGeneral(CancellationToken cancellationToken)</div><div class="ttdoc">Prompts the user to create a GeneralConfiguration.</div><div class="ttdef"><b>Definition:</b> <a href="_setup_wizard_8cs_source.html#l00672">SetupWizard.cs:672</a></div></div>
<div class="ttc" id="a_setup_wizard_8cs_html_adbd38b2960ebef44f65c5b8e0af409b0"><div class="ttname"><a href="_setup_wizard_8cs.html#adbd38b2960ebef44f65c5b8e0af409b0">ConfigureLogging</a></div><div class="ttdeci">async Task&lt; FileLoggingConfiguration &gt; ConfigureLogging(CancellationToken cancellationToken)</div><div class="ttdoc">Prompts the user to create a FileLoggingConfiguration.</div><div class="ttdef"><b>Definition:</b> <a href="_setup_wizard_8cs_source.html#l00730">SetupWizard.cs:730</a></div></div>
<div class="ttc" id="a_setup_wizard_8cs_html_afb6b6fca0a8f1d72dd4e4f5cc84f76f1"><div class="ttname"><a href="_setup_wizard_8cs.html#afb6b6fca0a8f1d72dd4e4f5cc84f76f1">SaveConfiguration</a></div><div class="ttdeci">async Task SaveConfiguration(string userConfigFileName, ushort? hostingPort, DatabaseConfiguration databaseConfiguration, GeneralConfiguration newGeneralConfiguration, FileLoggingConfiguration fileLoggingConfiguration, ElasticsearchConfiguration elasticsearchConfiguration, ControlPanelConfiguration controlPanelConfiguration, SwarmConfiguration swarmConfiguration, CancellationToken cancellationToken)</div><div class="ttdoc">Saves a given Configuration set to userConfigFileName .</div><div class="ttdef"><b>Definition:</b> <a href="_setup_wizard_8cs_source.html#l00972">SetupWizard.cs:972</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="_setup_wizard_8cs_source.html#l00867">ConfigureControlPanel()</a>, <a class="el" href="_setup_wizard_8cs_source.html#l00815">ConfigureElasticsearch()</a>, <a class="el" href="_setup_wizard_8cs_source.html#l00672">ConfigureGeneral()</a>, <a class="el" href="_setup_wizard_8cs_source.html#l00730">ConfigureLogging()</a>, <a class="el" href="_setup_wizard_8cs_source.html#l00897">ConfigureSwarm()</a>, and <a class="el" href="_setup_wizard_8cs_source.html#l00972">SaveConfiguration()</a>.</p>

<p class="reference">Referenced by <a class="el" href="_setup_wizard_8cs_source.html#l01095">CheckRunWizard()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="_setup_wizard_8cs_a133aa9167bebce98243748fe735a4e32_cgraph.png" border="0" usemap="#a_setup_wizard_8cs_a133aa9167bebce98243748fe735a4e32_cgraph" alt=""/></div>
<map name="a_setup_wizard_8cs_a133aa9167bebce98243748fe735a4e32_cgraph" id="a_setup_wizard_8cs_a133aa9167bebce98243748fe735a4e32_cgraph">
<area shape="rect" title="Runs the SetupWizard." alt="" coords="5,129,89,155"/>
<area shape="rect" href="_setup_wizard_8cs.html#a46a4314202bbe55ae8724e7d27486163" title="Prompts the user to create a ControlPanelConfiguration." alt="" coords="139,5,290,31"/>
<area shape="rect" href="_setup_wizard_8cs.html#a8c25292615cd1ecad91305b36ea7068e" title="Prompts the user to create a ElasticsearchConfiguration." alt="" coords="137,55,292,80"/>
<area shape="rect" href="_setup_wizard_8cs.html#a8c8f5f56a7438fe48011eb8d738abec8" title="Prompts the user to create a GeneralConfiguration." alt="" coords="154,104,275,129"/>
<area shape="rect" href="_setup_wizard_8cs.html#adbd38b2960ebef44f65c5b8e0af409b0" title="Prompts the user to create a FileLoggingConfiguration." alt="" coords="153,153,276,179"/>
<area shape="rect" href="_setup_wizard_8cs.html#a159af60f0c66366ede5c65cb6e21e5ea" title="Prompts the user to create a SwarmConfiguration." alt="" coords="156,203,273,228"/>
<area shape="rect" href="_setup_wizard_8cs.html#afb6b6fca0a8f1d72dd4e4f5cc84f76f1" title="Saves a given Configuration set to userConfigFileName ." alt="" coords="151,252,278,277"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="_setup_wizard_8cs_a133aa9167bebce98243748fe735a4e32_icgraph.png" border="0" usemap="#a_setup_wizard_8cs_a133aa9167bebce98243748fe735a4e32_icgraph" alt=""/></div>
<map name="a_setup_wizard_8cs_a133aa9167bebce98243748fe735a4e32_icgraph" id="a_setup_wizard_8cs_a133aa9167bebce98243748fe735a4e32_icgraph">
<area shape="rect" title="Runs the SetupWizard." alt="" coords="411,13,495,38"/>
<area shape="rect" href="_setup_wizard_8cs.html#aac16c05e965ab067e23152458aa6fe59" title="Check if it should and run the SetupWizard if necessary." alt="" coords="241,13,363,38"/>
<area shape="rect" href="class_tgstation_1_1_server_1_1_host_1_1_setup_1_1_setup_wizard.html#aa7320ced82b10bda77125684f2708839" title=" " alt="" coords="5,5,193,45"/>
</map>
</div>

</div>
</div>
<a id="afb6b6fca0a8f1d72dd4e4f5cc84f76f1" name="afb6b6fca0a8f1d72dd4e4f5cc84f76f1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afb6b6fca0a8f1d72dd4e4f5cc84f76f1">&#9670;&#160;</a></span>SaveConfiguration()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">async Task SaveConfiguration </td>
          <td>(</td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>userConfigFileName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ushort?&#160;</td>
          <td class="paramname"><em>hostingPort</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_database_configuration.html">DatabaseConfiguration</a>&#160;</td>
          <td class="paramname"><em>databaseConfiguration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_general_configuration.html">GeneralConfiguration</a>&#160;</td>
          <td class="paramname"><em>newGeneralConfiguration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_file_logging_configuration.html">FileLoggingConfiguration</a>&#160;</td>
          <td class="paramname"><em>fileLoggingConfiguration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_elasticsearch_configuration.html">ElasticsearchConfiguration</a>&#160;</td>
          <td class="paramname"><em>elasticsearchConfiguration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_control_panel_configuration.html">ControlPanelConfiguration</a>&#160;</td>
          <td class="paramname"><em>controlPanelConfiguration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_swarm_configuration.html">SwarmConfiguration</a>&#160;</td>
          <td class="paramname"><em>swarmConfiguration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CancellationToken&#160;</td>
          <td class="paramname"><em>cancellationToken</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Saves a given Configuration set to <em>userConfigFileName</em> .  </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">userConfigFileName</td><td>The file to save the Configuration to.</td></tr>
    <tr><td class="paramname">hostingPort</td><td>The hosting port to save.</td></tr>
    <tr><td class="paramname">databaseConfiguration</td><td>The DatabaseConfiguration to save.</td></tr>
    <tr><td class="paramname">newGeneralConfiguration</td><td>The GeneralConfiguration to save.</td></tr>
    <tr><td class="paramname">fileLoggingConfiguration</td><td>The FileLoggingConfiguration to save.</td></tr>
    <tr><td class="paramname">elasticsearchConfiguration</td><td>The ElasticsearchConfiguration to save.</td></tr>
    <tr><td class="paramname">controlPanelConfiguration</td><td>The ControlPanelConfiguration to save.</td></tr>
    <tr><td class="paramname">swarmConfiguration</td><td>The SwarmConfiguration to save.</td></tr>
    <tr><td class="paramname">cancellationToken</td><td>The CancellationToken for the operation.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A Task representing the running operation.</dd></dl>

<p class="definition">Definition at line <a class="el" href="_setup_wizard_8cs_source.html#l00972">972</a> of file <a class="el" href="_setup_wizard_8cs_source.html">SetupWizard.cs</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  982</span>        {</div>
<div class="line"><span class="lineno">  983</span>            await console.WriteAsync(String.Format(CultureInfo.InvariantCulture, <span class="stringliteral">&quot;Configuration complete! Saving to {0}&quot;</span>, userConfigFileName), <span class="keyword">true</span>, cancellationToken);</div>
<div class="line"><span class="lineno">  984</span> </div>
<div class="line"><span class="lineno">  985</span>            newGeneralConfiguration.ApiPort = hostingPort ?? <a class="code hl_class" href="class_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_general_configuration.html">GeneralConfiguration</a>.<a class="code hl_variable" href="class_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_general_configuration.html#a34554b3c3ec4b265081f7af8b8d99715">DefaultApiPort</a>;</div>
<div class="line"><span class="lineno">  986</span>            newGeneralConfiguration.ConfigVersion = <a class="code hl_class" href="class_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_general_configuration.html">GeneralConfiguration</a>.<a class="code hl_variable" href="class_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_general_configuration.html#a11cacc87b093badf8b45cc9fd858df54">CurrentConfigVersion</a>;</div>
<div class="line"><span class="lineno">  987</span>            var map = <span class="keyword">new</span> Dictionary&lt;string, object&gt;()</div>
<div class="line"><span class="lineno">  988</span>            {</div>
<div class="line"><span class="lineno">  989</span>                { <a class="code hl_class" href="class_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_database_configuration.html">DatabaseConfiguration</a>.<a class="code hl_variable" href="class_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_database_configuration.html#a3c3201b453ffd190158839da139e4a13">Section</a>, databaseConfiguration },</div>
<div class="line"><span class="lineno">  990</span>                { <a class="code hl_class" href="class_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_general_configuration.html">GeneralConfiguration</a>.<a class="code hl_variable" href="class_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_general_configuration.html#a04dc43bd8ff33f4a8a791f750f7eb1d9">Section</a>, newGeneralConfiguration },</div>
<div class="line"><span class="lineno">  991</span>                { <a class="code hl_class" href="class_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_file_logging_configuration.html">FileLoggingConfiguration</a>.<a class="code hl_variable" href="class_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_file_logging_configuration.html#a8450ea7764591aa38857686d8fc70f93">Section</a>, fileLoggingConfiguration },</div>
<div class="line"><span class="lineno">  992</span>                { <a class="code hl_class" href="class_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_elasticsearch_configuration.html">ElasticsearchConfiguration</a>.<a class="code hl_variable" href="class_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_elasticsearch_configuration.html#ac3eaafd5c44e6447a15c3992086b03f3">Section</a>, elasticsearchConfiguration },</div>
<div class="line"><span class="lineno">  993</span>                { <a class="code hl_class" href="class_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_control_panel_configuration.html">ControlPanelConfiguration</a>.<a class="code hl_variable" href="class_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_control_panel_configuration.html#adbbc553f0fd0f2eb4a69a8361c5a9c80">Section</a>, controlPanelConfiguration },</div>
<div class="line"><span class="lineno">  994</span>                { <a class="code hl_class" href="class_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_swarm_configuration.html">SwarmConfiguration</a>.<a class="code hl_variable" href="class_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_swarm_configuration.html#a4112bcb9a326ef189a140db42f90a332">Section</a>, swarmConfiguration },</div>
<div class="line"><span class="lineno">  995</span>            };</div>
<div class="line"><span class="lineno">  996</span> </div>
<div class="line"><span class="lineno">  997</span>            var builder = <span class="keyword">new</span> SerializerBuilder()</div>
<div class="line"><span class="lineno">  998</span>                .WithTypeConverter(<span class="keyword">new</span> <a class="code hl_class" href="class_tgstation_1_1_server_1_1_host_1_1_extensions_1_1_converters_1_1_version_converter.html">VersionConverter</a>());</div>
<div class="line"><span class="lineno">  999</span> </div>
<div class="line"><span class="lineno"> 1000</span>            <span class="keywordflow">if</span> (userConfigFileName.EndsWith(<span class="stringliteral">&quot;.json&quot;</span>, StringComparison.OrdinalIgnoreCase))</div>
<div class="line"><span class="lineno"> 1001</span>                builder.JsonCompatible();</div>
<div class="line"><span class="lineno"> 1002</span> </div>
<div class="line"><span class="lineno"> 1003</span>            var serializer = <span class="keyword">new</span> SerializerBuilder()</div>
<div class="line"><span class="lineno"> 1004</span>                .WithTypeConverter(<span class="keyword">new</span> <a class="code hl_class" href="class_tgstation_1_1_server_1_1_host_1_1_extensions_1_1_converters_1_1_version_converter.html">VersionConverter</a>())</div>
<div class="line"><span class="lineno"> 1005</span>                .Build();</div>
<div class="line"><span class="lineno"> 1006</span> </div>
<div class="line"><span class="lineno"> 1007</span>            var serializedYaml = serializer.Serialize(map);</div>
<div class="line"><span class="lineno"> 1008</span> </div>
<div class="line"><span class="lineno"> 1009</span>            <span class="comment">// big hack, but, prevent the default control panel channel from being overridden</span></div>
<div class="line"><span class="lineno"> 1010</span>            serializedYaml = serializedYaml.Replace(</div>
<div class="line"><span class="lineno"> 1011</span>                $<span class="stringliteral">&quot;\n  {nameof(ControlPanelConfiguration.Channel)}: &quot;</span>,</div>
<div class="line"><span class="lineno"> 1012</span>                String.Empty,</div>
<div class="line"><span class="lineno"> 1013</span>                StringComparison.Ordinal)</div>
<div class="line"><span class="lineno"> 1014</span>                .Replace(<span class="stringliteral">&quot;\r&quot;</span>, String.Empty, StringComparison.Ordinal);</div>
<div class="line"><span class="lineno"> 1015</span> </div>
<div class="line"><span class="lineno"> 1016</span>            var configBytes = Encoding.UTF8.GetBytes(serializedYaml);</div>
<div class="line"><span class="lineno"> 1017</span> </div>
<div class="line"><span class="lineno"> 1018</span>            reloadTcs = <span class="keyword">new</span> TaskCompletionSource();</div>
<div class="line"><span class="lineno"> 1019</span> </div>
<div class="line"><span class="lineno"> 1020</span>            <span class="keywordflow">try</span></div>
<div class="line"><span class="lineno"> 1021</span>            {</div>
<div class="line"><span class="lineno"> 1022</span>                await ioManager.WriteAllBytes(</div>
<div class="line"><span class="lineno"> 1023</span>                    userConfigFileName,</div>
<div class="line"><span class="lineno"> 1024</span>                    configBytes,</div>
<div class="line"><span class="lineno"> 1025</span>                    cancellationToken);</div>
<div class="line"><span class="lineno"> 1026</span> </div>
<div class="line"><span class="lineno"> 1027</span>                <span class="comment">// Ensure the reload</span></div>
<div class="line"><span class="lineno"> 1028</span>                <span class="keywordflow">if</span> (generalConfiguration.SetupWizardMode != <a class="code hl_enumeration" href="namespace_tgstation_1_1_server_1_1_host_1_1_setup.html#ada83b66b0eb589bb855302d25c41e4de">SetupWizardMode</a>.Only)</div>
<div class="line"><span class="lineno"> 1029</span>                    <span class="keyword">using</span> (cancellationToken.Register(() =&gt; reloadTcs.TrySetCanceled()))</div>
<div class="line"><span class="lineno"> 1030</span>                        await reloadTcs.Task;</div>
<div class="line"><span class="lineno"> 1031</span>            }</div>
<div class="line"><span class="lineno"> 1032</span>            <span class="keywordflow">catch</span> (OperationCanceledException)</div>
<div class="line"><span class="lineno"> 1033</span>            {</div>
<div class="line"><span class="lineno"> 1034</span>                <span class="keywordflow">throw</span>;</div>
<div class="line"><span class="lineno"> 1035</span>            }</div>
<div class="line"><span class="lineno"> 1036</span>            <span class="keywordflow">catch</span> (Exception e)</div>
<div class="line"><span class="lineno"> 1037</span>            {</div>
<div class="line"><span class="lineno"> 1038</span>                await console.WriteAsync(e.Message, <span class="keyword">true</span>, cancellationToken);</div>
<div class="line"><span class="lineno"> 1039</span>                await console.WriteAsync(<span class="keyword">null</span>, <span class="keyword">true</span>, cancellationToken);</div>
<div class="line"><span class="lineno"> 1040</span>                await console.WriteAsync(<span class="stringliteral">&quot;For your convienence, here&#39;s the yaml we tried to write out:&quot;</span>, <span class="keyword">true</span>, cancellationToken);</div>
<div class="line"><span class="lineno"> 1041</span>                await console.WriteAsync(<span class="keyword">null</span>, <span class="keyword">true</span>, cancellationToken);</div>
<div class="line"><span class="lineno"> 1042</span>                await console.WriteAsync(serializedYaml, <span class="keyword">true</span>, cancellationToken);</div>
<div class="line"><span class="lineno"> 1043</span>                await console.WriteAsync(<span class="keyword">null</span>, <span class="keyword">true</span>, cancellationToken);</div>
<div class="line"><span class="lineno"> 1044</span>                await console.WriteAsync(<span class="stringliteral">&quot;Press any key to exit...&quot;</span>, <span class="keyword">true</span>, cancellationToken);</div>
<div class="line"><span class="lineno"> 1045</span>                await console.PressAnyKeyAsync(cancellationToken);</div>
<div class="line"><span class="lineno"> 1046</span>                <span class="keywordflow">throw</span> <span class="keyword">new</span> OperationCanceledException();</div>
<div class="line"><span class="lineno"> 1047</span>            }</div>
<div class="line"><span class="lineno"> 1048</span>        }</div>
<div class="ttc" id="aclass_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_control_panel_configuration_html_adbbc553f0fd0f2eb4a69a8361c5a9c80"><div class="ttname"><a href="class_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_control_panel_configuration.html#adbbc553f0fd0f2eb4a69a8361c5a9c80">Tgstation.Server.Host.Configuration.ControlPanelConfiguration.Section</a></div><div class="ttdeci">const string Section</div><div class="ttdoc">The key for the Microsoft.Extensions.Configuration.IConfigurationSection the ControlPanelConfiguratio...</div><div class="ttdef"><b>Definition:</b> <a href="_control_panel_configuration_8cs_source.html#l00013">ControlPanelConfiguration.cs:13</a></div></div>
<div class="ttc" id="aclass_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_database_configuration_html"><div class="ttname"><a href="class_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_database_configuration.html">Tgstation.Server.Host.Configuration.DatabaseConfiguration</a></div><div class="ttdoc">Configuration options for the Database.DatabaseContext.</div><div class="ttdef"><b>Definition:</b> <a href="_database_configuration_8cs_source.html#l00009">DatabaseConfiguration.cs:10</a></div></div>
<div class="ttc" id="aclass_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_database_configuration_html_a3c3201b453ffd190158839da139e4a13"><div class="ttname"><a href="class_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_database_configuration.html#a3c3201b453ffd190158839da139e4a13">Tgstation.Server.Host.Configuration.DatabaseConfiguration.Section</a></div><div class="ttdeci">const string Section</div><div class="ttdoc">The key for the Microsoft.Extensions.Configuration.IConfigurationSection the DatabaseConfiguration re...</div><div class="ttdef"><b>Definition:</b> <a href="_database_configuration_8cs_source.html#l00014">DatabaseConfiguration.cs:14</a></div></div>
<div class="ttc" id="aclass_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_elasticsearch_configuration_html_ac3eaafd5c44e6447a15c3992086b03f3"><div class="ttname"><a href="class_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_elasticsearch_configuration.html#ac3eaafd5c44e6447a15c3992086b03f3">Tgstation.Server.Host.Configuration.ElasticsearchConfiguration.Section</a></div><div class="ttdeci">const string Section</div><div class="ttdoc">The key for the Microsoft.Extensions.Configuration.IConfigurationSection the ElasticsearchConfigurati...</div><div class="ttdef"><b>Definition:</b> <a href="_elasticsearch_configuration_8cs_source.html#l00013">ElasticsearchConfiguration.cs:13</a></div></div>
<div class="ttc" id="aclass_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_file_logging_configuration_html_a8450ea7764591aa38857686d8fc70f93"><div class="ttname"><a href="class_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_file_logging_configuration.html#a8450ea7764591aa38857686d8fc70f93">Tgstation.Server.Host.Configuration.FileLoggingConfiguration.Section</a></div><div class="ttdeci">const string Section</div><div class="ttdoc">The key for the Microsoft.Extensions.Configuration.IConfigurationSection the FileLoggingConfiguration...</div><div class="ttdef"><b>Definition:</b> <a href="_file_logging_configuration_8cs_source.html#l00020">FileLoggingConfiguration.cs:20</a></div></div>
<div class="ttc" id="aclass_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_general_configuration_html_a04dc43bd8ff33f4a8a791f750f7eb1d9"><div class="ttname"><a href="class_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_general_configuration.html#a04dc43bd8ff33f4a8a791f750f7eb1d9">Tgstation.Server.Host.Configuration.GeneralConfiguration.Section</a></div><div class="ttdeci">const string Section</div><div class="ttdoc">The key for the Microsoft.Extensions.Configuration.IConfigurationSection the GeneralConfiguration res...</div><div class="ttdef"><b>Definition:</b> <a href="_general_configuration_8cs_source.html#l00022">GeneralConfiguration.cs:22</a></div></div>
<div class="ttc" id="aclass_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_general_configuration_html_a11cacc87b093badf8b45cc9fd858df54"><div class="ttname"><a href="class_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_general_configuration.html#a11cacc87b093badf8b45cc9fd858df54">Tgstation.Server.Host.Configuration.GeneralConfiguration.CurrentConfigVersion</a></div><div class="ttdeci">static readonly Version CurrentConfigVersion</div><div class="ttdoc">The current ConfigVersion.</div><div class="ttdef"><b>Definition:</b> <a href="_general_configuration_8cs_source.html#l00067">GeneralConfiguration.cs:67</a></div></div>
<div class="ttc" id="aclass_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_general_configuration_html_a34554b3c3ec4b265081f7af8b8d99715"><div class="ttname"><a href="class_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_general_configuration.html#a34554b3c3ec4b265081f7af8b8d99715">Tgstation.Server.Host.Configuration.GeneralConfiguration.DefaultApiPort</a></div><div class="ttdeci">const ushort DefaultApiPort</div><div class="ttdoc">The default value of ApiPort.</div><div class="ttdef"><b>Definition:</b> <a href="_general_configuration_8cs_source.html#l00027">GeneralConfiguration.cs:27</a></div></div>
<div class="ttc" id="aclass_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_swarm_configuration_html_a4112bcb9a326ef189a140db42f90a332"><div class="ttname"><a href="class_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_swarm_configuration.html#a4112bcb9a326ef189a140db42f90a332">Tgstation.Server.Host.Configuration.SwarmConfiguration.Section</a></div><div class="ttdeci">const string Section</div><div class="ttdoc">The key for the Microsoft.Extensions.Configuration.IConfigurationSection the SwarmConfiguration resid...</div><div class="ttdef"><b>Definition:</b> <a href="_swarm_configuration_8cs_source.html#l00016">SwarmConfiguration.cs:16</a></div></div>
<div class="ttc" id="aclass_tgstation_1_1_server_1_1_host_1_1_extensions_1_1_converters_1_1_version_converter_html"><div class="ttname"><a href="class_tgstation_1_1_server_1_1_host_1_1_extensions_1_1_converters_1_1_version_converter.html">Tgstation.Server.Host.Extensions.Converters.VersionConverter</a></div><div class="ttdoc">JsonConverter and IYamlTypeConverter for serializing global::System.Versions in semver format.</div><div class="ttdef"><b>Definition:</b> <a href="_version_converter_8cs_source.html#l00016">VersionConverter.cs:17</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="_general_configuration_8cs_source.html#l00067">Tgstation.Server.Host.Configuration.GeneralConfiguration.CurrentConfigVersion</a>, <a class="el" href="_general_configuration_8cs_source.html#l00027">Tgstation.Server.Host.Configuration.GeneralConfiguration.DefaultApiPort</a>, <a class="el" href="_control_panel_configuration_8cs_source.html#l00013">Tgstation.Server.Host.Configuration.ControlPanelConfiguration.Section</a>, <a class="el" href="_database_configuration_8cs_source.html#l00014">Tgstation.Server.Host.Configuration.DatabaseConfiguration.Section</a>, <a class="el" href="_elasticsearch_configuration_8cs_source.html#l00013">Tgstation.Server.Host.Configuration.ElasticsearchConfiguration.Section</a>, <a class="el" href="_file_logging_configuration_8cs_source.html#l00020">Tgstation.Server.Host.Configuration.FileLoggingConfiguration.Section</a>, <a class="el" href="_general_configuration_8cs_source.html#l00022">Tgstation.Server.Host.Configuration.GeneralConfiguration.Section</a>, and <a class="el" href="_swarm_configuration_8cs_source.html#l00016">Tgstation.Server.Host.Configuration.SwarmConfiguration.Section</a>.</p>

<p class="reference">Referenced by <a class="el" href="_setup_wizard_8cs_source.html#l01056">RunWizard()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="_setup_wizard_8cs_afb6b6fca0a8f1d72dd4e4f5cc84f76f1_icgraph.png" border="0" usemap="#a_setup_wizard_8cs_afb6b6fca0a8f1d72dd4e4f5cc84f76f1_icgraph" alt=""/></div>
<map name="a_setup_wizard_8cs_afb6b6fca0a8f1d72dd4e4f5cc84f76f1_icgraph" id="a_setup_wizard_8cs_afb6b6fca0a8f1d72dd4e4f5cc84f76f1_icgraph">
<area shape="rect" title="Saves a given Configuration set to userConfigFileName ." alt="" coords="543,13,669,38"/>
<area shape="rect" href="_setup_wizard_8cs.html#a133aa9167bebce98243748fe735a4e32" title="Runs the SetupWizard." alt="" coords="411,13,495,38"/>
<area shape="rect" href="_setup_wizard_8cs.html#aac16c05e965ab067e23152458aa6fe59" title="Check if it should and run the SetupWizard if necessary." alt="" coords="241,13,363,38"/>
<area shape="rect" href="class_tgstation_1_1_server_1_1_host_1_1_setup_1_1_setup_wizard.html#aa7320ced82b10bda77125684f2708839" title=" " alt="" coords="5,5,193,45"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5
</small></address>
</body>
</html>
